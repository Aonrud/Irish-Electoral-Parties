!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";var t={header:!0,newlineChar:"",delimiterChar:"",quoteChar:'"',detectCharLength:1024,emptyFieldValue:"",coerceField:t=>t,commentPrefixValue:!1,errorOnComment:!0,errorOnEmptyLine:!0,errorOnExtraFields:!0,errorOnMissingFields:!0},e=t=>t.length,n=(n={})=>{let o={...t,...n};o.escapeChar??=o.quoteChar;let i,a,s,c,d,{header:u,newlineChar:l,delimiterChar:p}=o,{detectCharLength:f,quoteChar:h,escapeChar:m,commentPrefixValue:g,emptyFieldValue:y,coerceField:v,errorOnEmptyLine:b,errorOnComment:w,errorOnExtraFields:x,errorOnMissingFields:_}=o,E=e(u),O=/,|\t|\||;|\x1E|\x1F/g,C=/\r\n|\n|\r/g,A=new RegExp(`${(t=>t.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"))(m+h)}`,"g"),S=m===h,k=m!==h,T=e(l),L="",I=0,M=t=>{if(I+=1,!0===u)return u=t,void(E=e(u));let n=t;if(E){let r=e(t);if(_&&r<E)return void P("MissingFields",`Too few fields were parsed, expected ${E}.`);if(E<r){if(x)return void P("ExtraFields",`Too many fields were parsed, expected ${E}.`);r=E}n={};for(let e=0;e<r;e++)n[u[e]]=t[e]}d({idx:I,data:n})},P=(t,e)=>{d({idx:I,err:{code:t,message:e}})},D=(t,e=s)=>i.indexOf(t,e),W=t=>i.substring(s,t),j=(t,e)=>{c.push(((t,e)=>v(t||y,e))(t,e))},B=()=>D(l)===s?(I+=1,s+=T,b&&P("EmptyLineExists","Empty line detected."),B()):g&&D(g)===s?(I+=1,s=D(l)+T,w&&P("CommentExists","Comment detected."),B()):void 0;return{chunkParse:(t,n,o=!1)=>{if(i=t,a=e(i),d=n.enqueue,L="",s=0,c=[],!l){if(l=r(i.substring(0,f),C),!l){if(i.length<f&&!o)return void(L=i);throw new Error("newlineCharUnknown")}T=e(l)}p||=r(i.substring(0,f),O),B();let u=0;for(;;){let t,e,n,r=s;if(i[s]===h)for(s+=1,t=!0,r=s;;){if(r=D(h,r),r<0){if(L=i.substring(u,a)+L,o)throw new Error("QuotedFieldMalformed",{cause:I});return}if(S&&i[r+1]===h)r+=2;else{if(!k||i[r-1]!==m)break;r+=1}}let d,f=D(p,r),g=D(l,r);if(g<0){if(!o)return void(L=i.substring(u,a)+L);g=a}if(f>-1&&f<g?(r=f,e=1):(r=g,e=T,n=!0),r<0||!r)break;if(d=t?W(r-1).replace(A,h):W(r),j(d,c.length),s=r+e,n&&(M(c),c=[],B(),u=s),a<=s&&0===c.length)break}},header:()=>u,previousChunk:()=>L}},r=(t,e)=>{let n,r={};for(;n=e.exec(t);){let t=n[0];if(r[t]??=0,r[t]+=1,r[t]>5)return t}let{key:o}=Object.keys(r).map((t=>({key:t,value:r[t]}))).sort(((t,e)=>t.value-e.value))?.[0]??{};if(o)return o};const o=(e,r)=>{let o={...t,enableReturn:!0,chunkSize:67108864,enqueue:()=>{},...r},{chunkSize:i,enableReturn:a,enqueue:s}=o,{chunkParse:c,previousChunk:d}=n(o),u=[],l={enqueue:s};a&&(l.enqueue=t=>{s(t),u.push(t.data)});let p=0;for(;p<e.length;){c(d()+e.substring(p,p+i),l),p+=i}return c(d(),l,!0),a&&u};var i=function(){return i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)};function a(t,e){for(var n=t.length;n--;)if(t[n].pointerId===e.pointerId)return n;return-1}function s(t,e){var n;if(e.touches){n=0;for(var r=0,o=e.touches;r<o.length;r++){var i=o[r];i.pointerId=n++,s(t,i)}}else(n=a(t,e))>-1&&t.splice(n,1),t.push(e)}function c(t){for(var e,n=(t=t.slice(0)).pop();e=t.pop();)n={clientX:(e.clientX-n.clientX)/2+n.clientX,clientY:(e.clientY-n.clientY)/2+n.clientY};return n}function d(t){if(t.length<2)return 0;var e=t[0],n=t[1];return Math.sqrt(Math.pow(Math.abs(n.clientX-e.clientX),2)+Math.pow(Math.abs(n.clientY-e.clientY),2))}"undefined"!=typeof window&&(window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:null};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}));var u={down:"mousedown",move:"mousemove",up:"mouseup mouseleave"};function l(t,e,n,r){u[t].split(" ").forEach((function(t){e.addEventListener(t,n,r)}))}function p(t,e,n){u[t].split(" ").forEach((function(t){e.removeEventListener(t,n)}))}"undefined"!=typeof window&&("function"==typeof window.PointerEvent?u={down:"pointerdown",move:"pointermove",up:"pointerup pointerleave pointercancel"}:"function"==typeof window.TouchEvent&&(u={down:"touchstart",move:"touchmove",up:"touchend touchcancel"}));var f,h="undefined"!=typeof document&&!!document.documentMode;function m(){return f||(f=document.createElement("div").style)}var g=["webkit","moz","ms"],y={};function v(t){if(y[t])return y[t];var e=m();if(t in e)return y[t]=t;for(var n=t[0].toUpperCase()+t.slice(1),r=g.length;r--;){var o="".concat(g[r]).concat(n);if(o in e)return y[t]=o}}function b(t,e){return parseFloat(e[v(t)])||0}function w(t,e,n){void 0===n&&(n=window.getComputedStyle(t));var r="border"===e?"Width":"";return{left:b("".concat(e,"Left").concat(r),n),right:b("".concat(e,"Right").concat(r),n),top:b("".concat(e,"Top").concat(r),n),bottom:b("".concat(e,"Bottom").concat(r),n)}}function x(t,e,n){t.style[v(e)]=n}function _(t){var e=t.parentNode,n=window.getComputedStyle(t),r=window.getComputedStyle(e),o=t.getBoundingClientRect(),i=e.getBoundingClientRect();return{elem:{style:n,width:o.width,height:o.height,top:o.top,bottom:o.bottom,left:o.left,right:o.right,margin:w(t,"margin",n),border:w(t,"border",n)},parent:{style:r,width:i.width,height:i.height,top:i.top,bottom:i.bottom,left:i.left,right:i.right,padding:w(e,"padding",r),border:w(e,"border",r)}}}function E(t,e){return 1===t.nodeType&&" ".concat(function(t){return(t.getAttribute("class")||"").trim()}(t)," ").indexOf(" ".concat(e," "))>-1}var O=/^http:[\w\.\/]+svg$/;var C={animate:!1,canvas:!1,cursor:"move",disablePan:!1,disableZoom:!1,disableXAxis:!1,disableYAxis:!1,duration:200,easing:"ease-in-out",exclude:[],excludeClass:"panzoom-exclude",handleStartEvent:function(t){t.preventDefault(),t.stopPropagation()},maxScale:4,minScale:.125,overflow:"hidden",panOnlyWhenZoomed:!1,pinchAndPan:!1,relative:!1,setTransform:function(t,e,n){var r=e.x,o=e.y,i=e.scale,a=e.isSVG;if(x(t,"transform","scale(".concat(i,") translate(").concat(r,"px, ").concat(o,"px)")),a&&h){var s=window.getComputedStyle(t).getPropertyValue("transform");t.setAttribute("transform",s)}},startX:0,startY:0,startScale:1,step:.3,touchAction:"none"};function A(t,e){if(!t)throw new Error("Panzoom requires an element as an argument");if(1!==t.nodeType)throw new Error("Panzoom requires an element with a nodeType of 1");if(!function(t){var e=t.ownerDocument,n=t.parentNode;return e&&n&&9===e.nodeType&&1===n.nodeType&&e.documentElement.contains(n)}(t))throw new Error("Panzoom should be called on elements that have been attached to the DOM");e=i(i({},C),e);var n=function(t){return O.test(t.namespaceURI)&&"svg"!==t.nodeName.toLowerCase()}(t),r=t.parentNode;r.style.overflow=e.overflow,r.style.userSelect="none",r.style.touchAction=e.touchAction,(e.canvas?r:t).style.cursor=e.cursor,t.style.userSelect="none",t.style.touchAction=e.touchAction,x(t,"transformOrigin","string"==typeof e.origin?e.origin:n?"0 0":"50% 50%");var o,f,h,m,g,y,b=0,w=0,A=1,S=!1;function k(e,n,r){if(!r.silent){var o=new CustomEvent(e,{detail:n});t.dispatchEvent(o)}}function T(e,r,o){var i={x:b,y:w,scale:A,isSVG:n,originalEvent:o};return requestAnimationFrame((function(){"boolean"==typeof r.animate&&(r.animate?function(t,e){var n=v("transform");x(t,"transition","".concat(n," ").concat(e.duration,"ms ").concat(e.easing))}(t,r):x(t,"transition","none")),r.setTransform(t,i,r),k(e,i,r),k("panzoomchange",i,r)})),i}function L(n,r,o,a){var s=i(i({},e),a),c={x:b,y:w,opts:s};if(!s.force&&(s.disablePan||s.panOnlyWhenZoomed&&A===s.startScale))return c;if(n=parseFloat(n),r=parseFloat(r),s.disableXAxis||(c.x=(s.relative?b:0)+n),s.disableYAxis||(c.y=(s.relative?w:0)+r),s.contain){var d=_(t),u=d.elem.width/A,l=d.elem.height/A,p=u*o,f=l*o,h=(p-u)/2,m=(f-l)/2;if("inside"===s.contain){var g=(-d.elem.margin.left-d.parent.padding.left+h)/o,y=(d.parent.width-p-d.parent.padding.left-d.elem.margin.left-d.parent.border.left-d.parent.border.right+h)/o;c.x=Math.max(Math.min(c.x,y),g);var v=(-d.elem.margin.top-d.parent.padding.top+m)/o,x=(d.parent.height-f-d.parent.padding.top-d.elem.margin.top-d.parent.border.top-d.parent.border.bottom+m)/o;c.y=Math.max(Math.min(c.y,x),v)}else if("outside"===s.contain){g=(-(p-d.parent.width)-d.parent.padding.left-d.parent.border.left-d.parent.border.right+h)/o,y=(h-d.parent.padding.left)/o;c.x=Math.max(Math.min(c.x,y),g);v=(-(f-d.parent.height)-d.parent.padding.top-d.parent.border.top-d.parent.border.bottom+m)/o,x=(m-d.parent.padding.top)/o;c.y=Math.max(Math.min(c.y,x),v)}}return s.roundPixels&&(c.x=Math.round(c.x),c.y=Math.round(c.y)),c}function I(n,r){var o=i(i({},e),r),a={scale:A,opts:o};if(!o.force&&o.disableZoom)return a;var s=e.minScale,c=e.maxScale;if(o.contain){var d=_(t),u=d.elem.width/A,l=d.elem.height/A;if(u>1&&l>1){var p=(d.parent.width-d.parent.border.left-d.parent.border.right)/u,f=(d.parent.height-d.parent.border.top-d.parent.border.bottom)/l;"inside"===e.contain?c=Math.min(c,p,f):"outside"===e.contain&&(s=Math.max(s,p,f))}}return a.scale=Math.min(Math.max(n,s),c),a}function M(t,e,r,o){var i=L(t,e,A,r);return b!==i.x||w!==i.y?(b=i.x,w=i.y,T("panzoompan",i.opts,o)):{x:b,y:w,scale:A,isSVG:n,originalEvent:o}}function P(t,e,n){var r=I(t,e),o=r.opts;if(o.force||!o.disableZoom){t=r.scale;var i=b,a=w;if(o.focal){var s=o.focal;i=(s.x/t-s.x/A+b*t)/t,a=(s.y/t-s.y/A+w*t)/t}var c=L(i,a,t,{relative:!1,force:!0});return b=c.x,w=c.y,A=t,T("panzoomzoom",o,n)}}function D(t,n){var r=i(i(i({},e),{animate:!0}),n);return P(A*Math.exp((t?1:-1)*r.step),r)}function W(e,r,o,a){var s=_(t),c=s.parent.width-s.parent.padding.left-s.parent.padding.right-s.parent.border.left-s.parent.border.right,d=s.parent.height-s.parent.padding.top-s.parent.padding.bottom-s.parent.border.top-s.parent.border.bottom,u=r.clientX-s.parent.left-s.parent.padding.left-s.parent.border.left-s.elem.margin.left,l=r.clientY-s.parent.top-s.parent.padding.top-s.parent.border.top-s.elem.margin.top;n||(u-=s.elem.width/A/2,l-=s.elem.height/A/2);var p={x:u/c*(c*e),y:l/d*(d*e)};return P(e,i(i({},o),{animate:!1,focal:p}),a)}P(e.startScale,{animate:!1,force:!0}),setTimeout((function(){M(e.startX,e.startY,{animate:!1,force:!0})}));var j=[];function B(t){if(!function(t,e){for(var n=t;null!=n;n=n.parentNode)if(E(n,e.excludeClass)||e.exclude.indexOf(n)>-1)return!0;return!1}(t.target,e)){s(j,t),S=!0,e.handleStartEvent(t),o=b,f=w,k("panzoomstart",{x:b,y:w,scale:A,isSVG:n,originalEvent:t},e);var r=c(j);h=r.clientX,m=r.clientY,g=A,y=d(j)}}function z(t){if(S&&void 0!==o&&void 0!==f&&void 0!==h&&void 0!==m){s(j,t);var n=c(j),r=j.length>1,i=A;if(r)0===y&&(y=d(j)),W(i=I((d(j)-y)*e.step/80+g).scale,n,{animate:!1},t);r&&!e.pinchAndPan||M(o+(n.clientX-h)/i,f+(n.clientY-m)/i,{animate:!1},t)}}function H(t){1===j.length&&k("panzoomend",{x:b,y:w,scale:A,isSVG:n,originalEvent:t},e),function(t,e){if(e.touches)for(;t.length;)t.pop();else{var n=a(t,e);n>-1&&t.splice(n,1)}}(j,t),S&&(S=!1,o=f=h=m=void 0)}var $=!1;function R(){$||($=!0,l("down",e.canvas?r:t,B),l("move",document,z,{passive:!0}),l("up",document,H,{passive:!0}))}return e.noBind||R(),{bind:R,destroy:function(){$=!1,p("down",e.canvas?r:t,B),p("move",document,z),p("up",document,H)},eventNames:u,getPan:function(){return{x:b,y:w}},getScale:function(){return A},getOptions:function(){return function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(e)},handleDown:B,handleMove:z,handleUp:H,pan:M,reset:function(t){var n=i(i(i({},e),{animate:!0,force:!0}),t);A=I(n.startScale,n).scale;var r=L(n.startX,n.startY,A,n);return b=r.x,w=r.y,T("panzoomreset",n)},resetStyle:function(){r.style.overflow="",r.style.userSelect="",r.style.touchAction="",r.style.cursor="",t.style.cursor="",t.style.userSelect="",t.style.touchAction="",x(t,"transformOrigin","")},setOptions:function(n){for(var o in void 0===n&&(n={}),n)n.hasOwnProperty(o)&&(e[o]=n[o]);(n.hasOwnProperty("cursor")||n.hasOwnProperty("canvas"))&&(r.style.cursor=t.style.cursor="",(e.canvas?r:t).style.cursor=e.cursor),n.hasOwnProperty("overflow")&&(r.style.overflow=n.overflow),n.hasOwnProperty("touchAction")&&(r.style.touchAction=n.touchAction,t.style.touchAction=n.touchAction)},setStyle:function(e,n){return x(t,e,n)},zoom:P,zoomIn:function(t){return D(!0,t)},zoomOut:function(t){return D(!1,t)},zoomToPoint:W,zoomWithWheel:function(t,n){t.preventDefault();var r=i(i(i({},e),n),{animate:!1}),o=(0===t.deltaY&&t.deltaX?t.deltaX:t.deltaY)<0?1:-1;return W(I(A*Math.exp(o*r.step/3),r).scale,t,r,t)}}}A.defaultOptions=C;
/*! Timeline
   *Copyright (C) 2021 Aonghus Storey
   *
   * This program is free software: you can redistribute it and/or modify
   * it under the terms of the GNU General Public License as published by
   * the Free Software Foundation, either version 3 of the License, or
   * (at your option) any later version.
   *
   * This program is distributed in the hope that it will be useful,
   * but WITHOUT ANY WARRANTY; without even the implied warranty of
   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   * GNU General Public License for more details.
   *
   * You should have received a copy of the GNU General Public License
   * along with this program.  If not, see <http://www.gnu.org/licenses/>.
   */
const S="http://www.w3.org/2000/svg";class k{static draw({start:t,end:e,stroke:n,colour:r,markers:o=[],dashes:i="",title:a=""}={}){const s=2*n,c=e.x-t.x,d=e.y-t.y,u={x1:s,y1:s,x2:c+s,y2:d+s};e.x<t.x&&(u.x1+=Math.abs(c),u.x2+=Math.abs(c)),e.y<t.y&&(u.y1+=Math.abs(d),u.y2+=Math.abs(d));const l=Math.min(t.x,e.x)-s,p=Math.min(t.y,e.y)-s;let f=document.createElementNS(S,"svg");f.setAttribute("width",Math.abs(c)+2*s),f.setAttribute("height",Math.abs(d)+2*s),f.setAttribute("style","position: absolute; left: "+l+"px; top: "+p+"px"),f.style.color=r;const h=this.drawLine(u,n,i,a);return h.setAttribute("data-coords",`[ ${t.x}, ${t.y} ], [ ${e.x}, ${e.y} ]`),f.append(h),f=this._addMarker(f,o[0],"start",u,n),f=this._addMarker(f,o[1],"end",u,n),f}static _addMarker(t,e,n,r,o){return"circle"==e&&t.append(this._drawCircleMarker(n,r,o)),"square"==e&&t.append(this._drawSquareMarker(n,r,o)),"dots"==e&&"end"==n&&(t.setAttribute("width",parseInt(t.getAttribute("width"))+2*o),t.append(this._drawDotsEnd(r,o))),t}static _drawSquareMarker(t,e,n){let[r,o]=[e.x1-n,e.y1-n];return"end"==t&&([r,o]=[e.x2-n,e.y2-n]),this.drawSquare(r,o,2.5*n)}static _drawCircleMarker(t,e,n){let[r,o]=[e.x1,e.y1];return"end"==t&&([r,o]=[e.x2,e.y2]),this.drawCircle(r,o,n)}static _drawDotsEnd(t,e){let n=t.x2;t.x2<t.x1&&(n=t.x2-5*e),t.x2>t.x1&&(n=t.x2+5*e);let r=t.y2;t.y2<t.y1&&(r=t.y2-2*e),t.y2>t.y1&&(r=t.y2+2*e);const o={x1:t.x2,y1:t.y2,x2:n,y2:r};return this.drawLine(o,e,`0 ${e} ${e} ${e} ${e}`)}static drawLine(t,e,n="",r=""){const o=document.createElementNS(S,"line");return o.setAttribute("x1",t.x1),o.setAttribute("y1",t.y1),o.setAttribute("x2",t.x2),o.setAttribute("y2",t.y2),o.setAttribute("stroke-width",e),o.setAttribute("stroke-dasharray",n),o.setAttribute("stroke","currentColor"),r&&o.append(this._createTitle(r)),o}static drawCircle(t,e,n,r=""){const o=document.createElementNS(S,"circle");return o.setAttribute("cx",t),o.setAttribute("cy",e),o.setAttribute("r",n),o.setAttribute("fill","currentColor"),r&&o.append(this._createTitle(r)),o}static drawSquare(t,e,n,r=""){const o=document.createElementNS(S,"rect");return o.setAttribute("x",t),o.setAttribute("y",e),o.setAttribute("width",n),o.setAttribute("height",n),o.setAttribute("fill","currentColor"),r&&o.append(this._createTitle(r)),o}static _createTitle(t){const e=document.createElementNS(S,"title");return e.append(document.createTextNode(t)),e.dataset.title=t,console.log(t),e}}class T{constructor(t,e=1900,n=1){this._years=t,this._yearStart=e,this._grid=Array.from(Array(n+1),(()=>new Array(t).fill(!1)))}setEntryRow(t){const e=this._yearToGrid(t.dataset.start),n=this._yearToGrid(this._calcGroupEnd(t));let r=null,o=null;if(t.dataset.split&&(r=document.getElementById(t.dataset.split)),t.dataset.merge){const e=document.getElementById(t.dataset.merge);e.dataset.split!==t.id&&(r=e)}r&&null===o&&(r.dataset.row||this.setEntryRow(r),o=parseInt(r.dataset.row));const i=this._calcEntryRow(t,e,n,o);t.dataset.row=i,this._setGroupRow(t);try{this._blockGridSpace(i,e,n)}catch(e){console.log(`${e}: called for ${t.id} with row ${i}`)}}_yearToGrid(t){return parseInt(t)-parseInt(this._yearStart)}get rows(){return this._grid.length}_setGroupRow(t){if(t.dataset.become){const e=document.getElementById(t.dataset.become);if(e.dataset.row){const t=e.dataset.start-this._yearStart,n=e.dataset.end-this._yearStart;this._freeGridSpace(e.dataset.row,t,n)}e.dataset.row=t.dataset.row,this._setGroupRow(e)}}_calcEntryRow(t,e,n,r=null){return t.dataset.row?t.dataset.row:r?this._findNearestGridSpace(parseInt(r),e,n):this._findGridSpace(e,n)}_calcGroupEnd(t){let e=t.dataset.end;return t.dataset.become&&(e=this._calcGroupEnd(document.getElementById(t.dataset.become))),e}_findGridSpace(t,e){let n=Math.floor(this.rows/2),r=!1;for(let o=0;o<this.rows;o++){if(n=r?n-o:n+o,console.log(`Checking row ${n}`),this._checkGridSpace(n,t,e))return console.log(`${n} available.`),n;r=!r}return this._addGridRow(),this.rows-1}_findNearestGridSpace(t,e,n){let r=t,o=t;if(this._checkGridSpace(t,e,n))return t;for(;r>-1&&!this._checkGridSpace(r,e,n);)r--;for(;o<this.rows&&!this._checkGridSpace(o,e,n);)o++;return-1==r&&o==this.rows?(this._addGridRow(),this.rows-1):o==this.rows?r:-1==r?o:t-r<=o-t?r:o}_addGridRow(){this._grid.push(new Array(this._years).fill(!1))}_checkGridSpace(t,e,n){t>this._grid.length-1&&console.log(this._grid),e===n&&(n+=1);return this._grid[t].slice(e,n).every((t=>!1===t))}_blockGridSpace(t,e,n){this._markGridSpace(t,e,n,!0)}_freeGridSpace(t,e,n){this._markGridSpace(t,e,n,!1)}_markGridSpace(t,e,n,r){if(!this._grid[t])throw new Error(`Attempt to mark non-existent grid row ${t}`);let o=0;for(;o<n-e;)this._grid[t][e+o]=r,o++;e>0&&(this._grid[t][e-1]=r),n<this._grid[0].length-1&&(this._grid[t][n]=r)}}function L(t,e){let n={};for(const r in t)e.hasOwnProperty(r)?n[r]=e[r]:n[r]=t[r];return n}const I={yearStart:1900,yearEnd:(new Date).getFullYear()+1,strokeWidth:4,yearWidth:50,rowHeight:50,padding:5,boxWidth:100,guides:!0,guideInterval:5,entrySelector:"div",linkDashes:"4",irregularDashes:"88 4 4 4"};class M{constructor(t,e={}){this._config=this._makeConfig(e),this._applyCSSProperties(),this._container=document.getElementById(t),this._entries=document.querySelectorAll("#"+t+" > "+this._config.entrySelector+":not(.timeline-exclude):not(.event)"),this._events=this._container.querySelectorAll(".event")}_makeConfig(t){const e=L(I,t);return e.boxHeight=e.rowHeight-2*e.padding,e.boxMinWidth=e.boxHeight,e}_setConfigProp(t,e){this._config[t]=e}create(){return this._setup(),this._draw(),this._addDates(),!0===this._config.guides&&this._addGuides(),this._container}_setup(){this._prepareEntries(),this._prepareRows(),this._container.classList.add("timeline-container"),this._container.style.height=(this._config.rows+2)*this._config.rowHeight+"px",this._container.style.width=(this._config.yearEnd+1-this._config.yearStart)*this._config.yearWidth+"px",this._setEntries(),this._setEvents()}_prepareEntries(){for(const t of this._entries){t.classList.add("entry"),t.dataset.end=this._calcEnd(t),parseInt(t.dataset.start)<this._config.yearStart&&(t.classList.add("preexists"),t.dataset.start=this._config.yearStart);for(const e of["become","split","merge","links"])if(t.dataset.hasOwnProperty(e))for(const n of t.dataset[e].split(" "))document.getElementById(n)||(console.warn(`${t.id}: Given ${e} ID "${n}" doesn't exist. Ignoring.`),delete t.dataset[e])}}_prepareRows(){let t=1;for(const e of this._entries)parseInt(e.dataset.row)>t&&(t=parseInt(e.dataset.row));if("function"==typeof T){const e=this._config.yearEnd-this._config.yearStart,n=new T(e,this._config.yearStart,t);for(const t of this._entries)n.setEntryRow(t);t=n.rows}this._setConfigProp("rows",t)}_setEntries(){for(const t of this._entries)t.style.left=this._yearToWidth(t.dataset.start)+"px",t.style.top=this._calcTop(t)+"px",t.dataset.colour&&(t.style.borderColor=t.dataset.colour),!0===this._checkSmallEntry(t)&&t.classList.add("min");for(const t of this._container.querySelectorAll(this._config.entrySelector+"[data-become]"))t.dataset.start==document.getElementById(t.dataset.become).dataset.start&&(t.style.left=parseFloat(t.style.left)-this._config.boxMinWidth/2+"px",document.getElementById(t.dataset.become).style.left=parseFloat(document.getElementById(t.dataset.become).style.left)+this._config.boxMinWidth/2+"px")}_setEvents(){for(const t of this._events){if(t.dataset.target&&!document.getElementById(t.dataset.target)){console.warn(`Event has an invalid target – skipping: ${JSON.stringify(t)}`);continue}let e=this._config.rowHeight-t.offsetHeight,n=this._yearToWidth(t.dataset.year);const r=[...this._events].filter((e=>!e.dataset.target&&e.dataset.year==t.dataset.year));r.length>1&&0!==r.indexOf(t)&&(e-=.5*t.offsetHeight*r.indexOf(t));const o=document.createElement("span");if(o.dataset.year=t.dataset.year,o.innerText=t.innerText,t.innerText="",t.append(o),t.dataset.colour){const e=`colour-${t.dataset.colour.replace(/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~]/g,"")}`;t.classList.add(e);let n=`.event:not([data-target]).${e}:after { color: ${t.dataset.colour} }`;n+=`.event.${e}:hover span { color: ${t.dataset.colour} }`,this._addCss(n)}if(t.dataset.target){const r=document.getElementById(t.dataset.target);if(e=this._calcTop(r)+.5*(this._config.boxHeight-t.offsetHeight),n-=.5*t.offsetWidth,r.dataset.colour){const t=`.event[data-target="${r.id}"] {border-color: ${r.dataset.colour}; color: ${r.dataset.colour}; background-color: ${r.dataset.colour};}`;this._addCss(t)}}t.style.left=n+"px",t.style.top=e+"px"}}_addCss(t){if(!document.getElementById("tl-styles")){const t=document.createElement("style");t.id="tl-styles",t.setAttribute("type","text/css"),document.head.append(t)}document.getElementById("tl-styles").append(document.createTextNode(t))}_addDates(){const t=document.createElement("div");t.classList.add("dates");let e=this._config.yearStart;for(;e<this._config.yearEnd;){const n=document.createElement("date");n.style.left=this._yearToWidth(e)+"px";const r=document.createTextNode(e);n.append(r),t.append(n),e+=5}this._container.prepend(t);const n=t.cloneNode(!0);n.style.top=this._config.rows*this._config.rowHeight+"px",this._container.append(n)}_addGuides(){let t=this._config.yearStart;for(;t<Math.ceil(this._config.yearEnd/this._config.guideInterval)*this._config.guideInterval;){const e=document.createElement("div");e.classList.add("guide"),e.style.left=this._yearToWidth(t)+"px",e.style.width=this._config.yearWidth*this._config.guideInterval+"px",(t-this._config.yearStart)/this._config.guideInterval%2==1&&e.classList.add("odd"),this._container.append(e),t+=this._config.guideInterval}}_draw(){for(const t of this._entries){const e=t.dataset.colour?t.dataset.colour:"var(--tl-colour-stroke)",n="true"==t.dataset.irregular?this._config.irregularDashes:"";let r="",o="end",i=this._getJoinCoords(t,"right"),a={x:this._yearToWidth(t.dataset.end),y:i.y};if(t.dataset.hasOwnProperty("merge")||t.dataset.hasOwnProperty("become")||(r=t.dataset.endEstimate?"dots":"circle"),t.dataset.hasOwnProperty("become")&&(a=this._getJoinCoords(document.getElementById(t.dataset.become),"left"),o="become"),t.dataset.hasOwnProperty("merge")){t.dataset.start==t.dataset.end&&(a.x+=this._config.yearWidth);const n={x:a.x,y:this._getYCentre(document.getElementById(t.dataset.merge))};a.x=a.x-this._config.yearWidth;const r=k.draw({start:a,end:n,stroke:this._config.strokeWidth,colour:e});r.classList.add("merge"),this._container.append(r),o="merge"}if(t.dataset.start!==t.dataset.end){const t=k.draw({start:i,end:a,stroke:this._config.strokeWidth,colour:e,markers:["",r],dashes:n});t.classList.add(o),this._container.append(t)}t.dataset.hasOwnProperty("split")&&this._drawSplit(t,e),t.dataset.hasOwnProperty("links")&&this._drawLinks(t,e)}}_drawSplit(t,e){const n=document.getElementById(t.dataset.split);let r="top";parseInt(t.dataset.row)<parseInt(n.dataset.row)&&(r="bottom");const o={x:this._yearToWidth(t.dataset.start),y:this._getYCentre(n)},i=this._getJoinCoords(t,r),a=k.draw({start:o,end:i,stroke:this._config.strokeWidth,colour:e});a.classList.add("split"),this._container.append(a)}_drawLinks(t,e){const n=t.dataset.links.split(" ");let r={top:-1,bottom:-1,left:-1,right:-1};for(const o of n){const n=document.getElementById(o);let i,a,s={x:0,y:0},c={x:0,y:0};const d=parseInt(t.dataset.row),u=parseInt(n.dataset.row);d===u&&t.dataset.start<n.dataset.start&&(r.right=r.right+1,i="right",a="left"),d===u&&t.dataset.start>n.dataset.start&&(r.left=r.left+1,i="left",a="right"),d>u&&(r.top=r.top+1,i="top",a="bottom"),d<u&&(r.bottom=r.bottom+1,i="bottom",a="top"),s=this._getJoinCoords(t,i,r[i]),c={x:s.x,y:this._getYCentre(n)},t.dataset.start>=n.dataset.end&&(c.x=this._yearToWidth(n.dataset.end)),t.dataset.start==n.dataset.start&&(c=this._getJoinCoords(n,a));const l=k.draw({start:s,end:c,stroke:this._config.strokeWidth/2,colour:e,markers:["square","square"],dashes:this._config.linkDashes});l.classList.add("link"),this._container.append(l)}}_applyCSSProperties(){const t=document.documentElement;t.style.setProperty("--tl-width-year",this._config.yearWidth+"px"),t.style.setProperty("--tl-height-row",this._config.rowHeight+"px"),t.style.setProperty("--tl-width-box",this._config.boxWidth+"px"),t.style.setProperty("--tl-height-box",this._config.boxHeight+"px"),t.style.setProperty("--tl-width-box-min",this._config.boxHeight+"px"),t.style.setProperty("--tl-padding",this._config.padding+"px")}_getJoinCoords(t,e,n=0){const r=window.getComputedStyle(t),o=parseFloat(t.style.left),i=parseFloat(t.style.top),a=parseFloat(r.getPropertyValue("width")),s=parseFloat(r.getPropertyValue("height"));switch(e){case"left":return{x:o,y:i+s/2+5*n};case"right":return{x:o+a,y:i+s/2+5*n};case"top":return{x:o+a/2+5*n,y:i};case"bottom":return{x:o+a/2+5*n,y:i+s};default:throw`Invalid element side specified: Called with ${e}. Entry: ${t}`}}_calcEnd(t){return t.dataset.end?parseInt(t.dataset.end):t.dataset.become?parseInt(document.getElementById(t.dataset.become).dataset.start):parseInt(this._config.yearEnd)}_calcTop(t){return parseInt((parseInt(t.dataset.row)+1)*this._config.rowHeight+this._config.padding)}_checkSmallEntry(t){const e=t.dataset.start;return t.dataset.end-e<this._config.boxWidth/this._config.yearWidth}_getXCentre(t){return parseFloat(t.style.left)+this._config.boxWidth/2}_getYCentre(t){return parseFloat(t.style.top)+this._config.boxHeight/2}_yearToWidth(t){return parseInt((t-this._config.yearStart)*this._config.yearWidth)}}const P={panzoom:null,findForm:"timeline-find",zoomIn:"timeline-zoom-in",zoomOut:"timeline-zoom-out",zoomReset:"timeline-zoom-reset"};class D{constructor(t="diagram",e={},n=[],r=[]){this._container=t,this._setConfig(e);for(const t of n)this.addEntry(t);for(const t of r)this.addEvent(t)}create(){const t=new M(this._container,this._diagramConfig);this._diagram=t.create(),"function"==typeof this._config.panzoom&&(this._initPanzoom(),this._initControls(),window.addEventListener("hashchange",(t=>this._hashHandler(t)))),location.hash&&setTimeout((()=>{this._hashHandler()}))}_setConfig(t){this._config=L(P,t),this._diagramConfig=L(I,t)}addEntry(t){if(document.getElementById(t.id))return void console.warn(`Invalid entry: ${t.id} already exists.`);if(!["id","name","start"].every((e=>t.hasOwnProperty(e))))return void console.warn(`Invalid entry: ${JSON.stringify(t)}. Entries must have at least id, name and start values.`);const e=document.createElement("div");e.id=t.id,e.innerText=t.name;for(const n of Object.keys(t))["id","name"].includes(n)||(e.dataset[n]=t[n]);document.getElementById(this._container).append(e)}addEvent(t){if(!t.year||!t.content)return void console.warn(`Invalid event: ${JSON.stringify(t)}. Events must have at least a year and content property.`);const e=document.createElement("div");e.classList.add("event"),e.innerText=t.content;for(const n of Object.keys(t))"content"!=n&&(e.dataset[n]=t[n]);document.getElementById(this._container).append(e)}panToEntry(t){if(void 0===this._pz)throw new Error("Panzoom module missing. Include Panzoom to use the pan-to-entry feature.");const e=document.getElementById(t),n=window.innerWidth/2-parseInt(e.style.left)-this._diagramConfig.boxWidth/2,r=window.innerHeight/2-parseInt(e.style.top)-this._diagramConfig.rowHeight/2;this._pz.zoom(1),this._pz.pan(n,r);const o=new CustomEvent("timelineFind",{detail:{id:t,name:e.innerText}});document.getElementById(this._container).dispatchEvent(o),setTimeout((()=>{e.classList.add("highlight","hover")}),500),setTimeout((()=>{e.classList.remove("highlight","hover")}),2e3)}_initControls(){const t=document.getElementById(this._config.zoomIn),e=document.getElementById(this._config.zoomOut),n=document.getElementById(this._config.zoomReset),r=document.getElementById(this._config.findForm);t&&t.addEventListener("click",this._pz.zoomIn),e&&e.addEventListener("click",this._pz.zoomOut),n&&n.addEventListener("click",(()=>this._pz.zoom(1))),r&&this._initFindForm(r)}_initFindForm(t){const e=document.createElement("input");e.name="find-id",e.style.display="none",t.append(e);const n=t.querySelector("input[name=finder]"),r=document.createElement("div"),o=document.createElement("div"),i=document.createElement("ul");r.classList.add("filtered-entries"),r.appendChild(o),o.appendChild(i),n.parentNode.insertBefore(r,n),r.appendChild(n),n.autocomplete="off",o.style.width=n.offsetWidth+"px";const a={form:t,finder:n,id:e,results:i};this._findConfig=a,a.finder.value="",t.addEventListener("input",(t=>this._showEntryOptions(t))),t.addEventListener("submit",(t=>this._findSubmit(t))),i.addEventListener("click",(t=>this._selectFilteredEntry(t)))}_showEntryOptions(t){const e=t.target.value;if(""===e.trim())return this._findConfig.results.innerHTML="",null;const n=this._filterEntries(e),r=this._findConfig.results;r.innerHTML="";for(const t of n){const e=document.createElement("li");e.dataset.id=t.id,e.innerText=t.name,r.append(e)}}_filterEntries(t){return[...document.querySelectorAll(".entry")].map((t=>({id:t.id,name:t.innerText}))).filter((e=>e.name.toLowerCase().includes(t.toLowerCase())))}_selectFilteredEntry(t){if("li"!==t.target.localName)return null;const e=this._findConfig.form,n=this._findConfig.finder,r=this._findConfig.id;n.value=t.target.innerText,r.value=t.target.dataset.id,e.requestSubmit()}_findSubmit(t){t.preventDefault();const e=t.target.querySelector("input[name=find-id]").value;t.target.querySelector("input[name=finder]").value,document.getElementById(e)&&this.panToEntry(e),this._findConfig.results.innerHTML="",this._findConfig.finder.value=""}_initPanzoom(){const t=document.createElement("div");t.classList.add("pz-wrap"),this._diagram.parentNode.insertBefore(t,this._diagram),t.appendChild(this._diagram),this._pz=this._config.panzoom(this._diagram,{contain:"outside",maxScale:3,minScale:.5,step:.1,handleStartEvent:t=>{t.preventDefault()}}),this._diagram.parentElement.addEventListener("wheel",this._pz.zoomWithWheel)}_hashHandler(t){const e=location.hash.replace("#find-","");document.getElementById(e)&&this._pz&&this.panToEntry(e)}}var W="top",j="bottom",B="right",z="left",H="auto",$=[W,j,B,z],R="start",q="end",N="clippingParents",F="viewport",V="popper",G="reference",Y=$.reduce((function(t,e){return t.concat([e+"-"+R,e+"-"+q])}),[]),X=[].concat($,[H]).reduce((function(t,e){return t.concat([e,e+"-"+R,e+"-"+q])}),[]),U=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function J(t){return t?(t.nodeName||"").toLowerCase():null}function Z(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Q(t){return t instanceof Z(t).Element||t instanceof Element}function K(t){return t instanceof Z(t).HTMLElement||t instanceof HTMLElement}function tt(t){return"undefined"!=typeof ShadowRoot&&(t instanceof Z(t).ShadowRoot||t instanceof ShadowRoot)}var et={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var n=e.styles[t]||{},r=e.attributes[t]||{},o=e.elements[t];K(o)&&J(o)&&(Object.assign(o.style,n),Object.keys(r).forEach((function(t){var e=r[t];!1===e?o.removeAttribute(t):o.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach((function(t){var r=e.elements[t],o=e.attributes[t]||{},i=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:n[t]).reduce((function(t,e){return t[e]="",t}),{});K(r)&&J(r)&&(Object.assign(r.style,i),Object.keys(o).forEach((function(t){r.removeAttribute(t)})))}))}},requires:["computeStyles"]};function nt(t){return t.split("-")[0]}var rt=Math.max,ot=Math.min,it=Math.round;function at(){var t=navigator.userAgentData;return null!=t&&t.brands&&Array.isArray(t.brands)?t.brands.map((function(t){return t.brand+"/"+t.version})).join(" "):navigator.userAgent}function st(){return!/^((?!chrome|android).)*safari/i.test(at())}function ct(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var r=t.getBoundingClientRect(),o=1,i=1;e&&K(t)&&(o=t.offsetWidth>0&&it(r.width)/t.offsetWidth||1,i=t.offsetHeight>0&&it(r.height)/t.offsetHeight||1);var a=(Q(t)?Z(t):window).visualViewport,s=!st()&&n,c=(r.left+(s&&a?a.offsetLeft:0))/o,d=(r.top+(s&&a?a.offsetTop:0))/i,u=r.width/o,l=r.height/i;return{width:u,height:l,top:d,right:c+u,bottom:d+l,left:c,x:c,y:d}}function dt(t){var e=ct(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function ut(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&tt(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function lt(t){return Z(t).getComputedStyle(t)}function pt(t){return["table","td","th"].indexOf(J(t))>=0}function ft(t){return((Q(t)?t.ownerDocument:t.document)||window.document).documentElement}function ht(t){return"html"===J(t)?t:t.assignedSlot||t.parentNode||(tt(t)?t.host:null)||ft(t)}function mt(t){return K(t)&&"fixed"!==lt(t).position?t.offsetParent:null}function gt(t){for(var e=Z(t),n=mt(t);n&&pt(n)&&"static"===lt(n).position;)n=mt(n);return n&&("html"===J(n)||"body"===J(n)&&"static"===lt(n).position)?e:n||function(t){var e=/firefox/i.test(at());if(/Trident/i.test(at())&&K(t)&&"fixed"===lt(t).position)return null;var n=ht(t);for(tt(n)&&(n=n.host);K(n)&&["html","body"].indexOf(J(n))<0;){var r=lt(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||e&&"filter"===r.willChange||e&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(t)||e}function yt(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function vt(t,e,n){return rt(t,ot(e,n))}function bt(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function wt(t,e){return e.reduce((function(e,n){return e[n]=t,e}),{})}var xt={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,n=t.state,r=t.name,o=t.options,i=n.elements.arrow,a=n.modifiersData.popperOffsets,s=nt(n.placement),c=yt(s),d=[z,B].indexOf(s)>=0?"height":"width";if(i&&a){var u=function(t,e){return bt("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:wt(t,$))}(o.padding,n),l=dt(i),p="y"===c?W:z,f="y"===c?j:B,h=n.rects.reference[d]+n.rects.reference[c]-a[c]-n.rects.popper[d],m=a[c]-n.rects.reference[c],g=gt(i),y=g?"y"===c?g.clientHeight||0:g.clientWidth||0:0,v=h/2-m/2,b=u[p],w=y-l[d]-u[f],x=y/2-l[d]/2+v,_=vt(b,x,w),E=c;n.modifiersData[r]=((e={})[E]=_,e.centerOffset=_-x,e)}},effect:function(t){var e=t.state,n=t.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!=typeof r||(r=e.elements.popper.querySelector(r)))&&ut(e.elements.popper,r)&&(e.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function _t(t){return t.split("-")[1]}var Et={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ot(t){var e,n=t.popper,r=t.popperRect,o=t.placement,i=t.variation,a=t.offsets,s=t.position,c=t.gpuAcceleration,d=t.adaptive,u=t.roundOffsets,l=t.isFixed,p=a.x,f=void 0===p?0:p,h=a.y,m=void 0===h?0:h,g="function"==typeof u?u({x:f,y:m}):{x:f,y:m};f=g.x,m=g.y;var y=a.hasOwnProperty("x"),v=a.hasOwnProperty("y"),b=z,w=W,x=window;if(d){var _=gt(n),E="clientHeight",O="clientWidth";if(_===Z(n)&&"static"!==lt(_=ft(n)).position&&"absolute"===s&&(E="scrollHeight",O="scrollWidth"),o===W||(o===z||o===B)&&i===q)w=j,m-=(l&&_===x&&x.visualViewport?x.visualViewport.height:_[E])-r.height,m*=c?1:-1;if(o===z||(o===W||o===j)&&i===q)b=B,f-=(l&&_===x&&x.visualViewport?x.visualViewport.width:_[O])-r.width,f*=c?1:-1}var C,A=Object.assign({position:s},d&&Et),S=!0===u?function(t,e){var n=t.x,r=t.y,o=e.devicePixelRatio||1;return{x:it(n*o)/o||0,y:it(r*o)/o||0}}({x:f,y:m},Z(n)):{x:f,y:m};return f=S.x,m=S.y,c?Object.assign({},A,((C={})[w]=v?"0":"",C[b]=y?"0":"",C.transform=(x.devicePixelRatio||1)<=1?"translate("+f+"px, "+m+"px)":"translate3d("+f+"px, "+m+"px, 0)",C)):Object.assign({},A,((e={})[w]=v?m+"px":"",e[b]=y?f+"px":"",e.transform="",e))}var Ct={passive:!0};var At={left:"right",right:"left",bottom:"top",top:"bottom"};function St(t){return t.replace(/left|right|bottom|top/g,(function(t){return At[t]}))}var kt={start:"end",end:"start"};function Tt(t){return t.replace(/start|end/g,(function(t){return kt[t]}))}function Lt(t){var e=Z(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function It(t){return ct(ft(t)).left+Lt(t).scrollLeft}function Mt(t){var e=lt(t),n=e.overflow,r=e.overflowX,o=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function Pt(t){return["html","body","#document"].indexOf(J(t))>=0?t.ownerDocument.body:K(t)&&Mt(t)?t:Pt(ht(t))}function Dt(t,e){var n;void 0===e&&(e=[]);var r=Pt(t),o=r===(null==(n=t.ownerDocument)?void 0:n.body),i=Z(r),a=o?[i].concat(i.visualViewport||[],Mt(r)?r:[]):r,s=e.concat(a);return o?s:s.concat(Dt(ht(a)))}function Wt(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function jt(t,e,n){return e===F?Wt(function(t,e){var n=Z(t),r=ft(t),o=n.visualViewport,i=r.clientWidth,a=r.clientHeight,s=0,c=0;if(o){i=o.width,a=o.height;var d=st();(d||!d&&"fixed"===e)&&(s=o.offsetLeft,c=o.offsetTop)}return{width:i,height:a,x:s+It(t),y:c}}(t,n)):Q(e)?function(t,e){var n=ct(t,!1,"fixed"===e);return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}(e,n):Wt(function(t){var e,n=ft(t),r=Lt(t),o=null==(e=t.ownerDocument)?void 0:e.body,i=rt(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=rt(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-r.scrollLeft+It(t),c=-r.scrollTop;return"rtl"===lt(o||n).direction&&(s+=rt(n.clientWidth,o?o.clientWidth:0)-i),{width:i,height:a,x:s,y:c}}(ft(t)))}function Bt(t,e,n,r){var o="clippingParents"===e?function(t){var e=Dt(ht(t)),n=["absolute","fixed"].indexOf(lt(t).position)>=0&&K(t)?gt(t):t;return Q(n)?e.filter((function(t){return Q(t)&&ut(t,n)&&"body"!==J(t)})):[]}(t):[].concat(e),i=[].concat(o,[n]),a=i[0],s=i.reduce((function(e,n){var o=jt(t,n,r);return e.top=rt(o.top,e.top),e.right=ot(o.right,e.right),e.bottom=ot(o.bottom,e.bottom),e.left=rt(o.left,e.left),e}),jt(t,a,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function zt(t){var e,n=t.reference,r=t.element,o=t.placement,i=o?nt(o):null,a=o?_t(o):null,s=n.x+n.width/2-r.width/2,c=n.y+n.height/2-r.height/2;switch(i){case W:e={x:s,y:n.y-r.height};break;case j:e={x:s,y:n.y+n.height};break;case B:e={x:n.x+n.width,y:c};break;case z:e={x:n.x-r.width,y:c};break;default:e={x:n.x,y:n.y}}var d=i?yt(i):null;if(null!=d){var u="y"===d?"height":"width";switch(a){case R:e[d]=e[d]-(n[u]/2-r[u]/2);break;case q:e[d]=e[d]+(n[u]/2-r[u]/2)}}return e}function Ht(t,e){void 0===e&&(e={});var n=e,r=n.placement,o=void 0===r?t.placement:r,i=n.strategy,a=void 0===i?t.strategy:i,s=n.boundary,c=void 0===s?N:s,d=n.rootBoundary,u=void 0===d?F:d,l=n.elementContext,p=void 0===l?V:l,f=n.altBoundary,h=void 0!==f&&f,m=n.padding,g=void 0===m?0:m,y=bt("number"!=typeof g?g:wt(g,$)),v=p===V?G:V,b=t.rects.popper,w=t.elements[h?v:p],x=Bt(Q(w)?w:w.contextElement||ft(t.elements.popper),c,u,a),_=ct(t.elements.reference),E=zt({reference:_,element:b,strategy:"absolute",placement:o}),O=Wt(Object.assign({},b,E)),C=p===V?O:_,A={top:x.top-C.top+y.top,bottom:C.bottom-x.bottom+y.bottom,left:x.left-C.left+y.left,right:C.right-x.right+y.right},S=t.modifiersData.offset;if(p===V&&S){var k=S[o];Object.keys(A).forEach((function(t){var e=[B,j].indexOf(t)>=0?1:-1,n=[W,j].indexOf(t)>=0?"y":"x";A[t]+=k[n]*e}))}return A}function $t(t,e){void 0===e&&(e={});var n=e,r=n.placement,o=n.boundary,i=n.rootBoundary,a=n.padding,s=n.flipVariations,c=n.allowedAutoPlacements,d=void 0===c?X:c,u=_t(r),l=u?s?Y:Y.filter((function(t){return _t(t)===u})):$,p=l.filter((function(t){return d.indexOf(t)>=0}));0===p.length&&(p=l);var f=p.reduce((function(e,n){return e[n]=Ht(t,{placement:n,boundary:o,rootBoundary:i,padding:a})[nt(n)],e}),{});return Object.keys(f).sort((function(t,e){return f[t]-f[e]}))}var Rt={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var o=n.mainAxis,i=void 0===o||o,a=n.altAxis,s=void 0===a||a,c=n.fallbackPlacements,d=n.padding,u=n.boundary,l=n.rootBoundary,p=n.altBoundary,f=n.flipVariations,h=void 0===f||f,m=n.allowedAutoPlacements,g=e.options.placement,y=nt(g),v=c||(y===g||!h?[St(g)]:function(t){if(nt(t)===H)return[];var e=St(t);return[Tt(t),e,Tt(e)]}(g)),b=[g].concat(v).reduce((function(t,n){return t.concat(nt(n)===H?$t(e,{placement:n,boundary:u,rootBoundary:l,padding:d,flipVariations:h,allowedAutoPlacements:m}):n)}),[]),w=e.rects.reference,x=e.rects.popper,_=new Map,E=!0,O=b[0],C=0;C<b.length;C++){var A=b[C],S=nt(A),k=_t(A)===R,T=[W,j].indexOf(S)>=0,L=T?"width":"height",I=Ht(e,{placement:A,boundary:u,rootBoundary:l,altBoundary:p,padding:d}),M=T?k?B:z:k?j:W;w[L]>x[L]&&(M=St(M));var P=St(M),D=[];if(i&&D.push(I[S]<=0),s&&D.push(I[M]<=0,I[P]<=0),D.every((function(t){return t}))){O=A,E=!1;break}_.set(A,D)}if(E)for(var $=function(t){var e=b.find((function(e){var n=_.get(e);if(n)return n.slice(0,t).every((function(t){return t}))}));if(e)return O=e,"break"},q=h?3:1;q>0;q--){if("break"===$(q))break}e.placement!==O&&(e.modifiersData[r]._skip=!0,e.placement=O,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function qt(t,e,n){return void 0===n&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function Nt(t){return[W,B,j,z].some((function(e){return t[e]>=0}))}var Ft={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,n=t.options,r=t.name,o=n.offset,i=void 0===o?[0,0]:o,a=X.reduce((function(t,n){return t[n]=function(t,e,n){var r=nt(t),o=[z,W].indexOf(r)>=0?-1:1,i="function"==typeof n?n(Object.assign({},e,{placement:t})):n,a=i[0],s=i[1];return a=a||0,s=(s||0)*o,[z,B].indexOf(r)>=0?{x:s,y:a}:{x:a,y:s}}(n,e.rects,i),t}),{}),s=a[e.placement],c=s.x,d=s.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=c,e.modifiersData.popperOffsets.y+=d),e.modifiersData[r]=a}};var Vt={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,r=t.name,o=n.mainAxis,i=void 0===o||o,a=n.altAxis,s=void 0!==a&&a,c=n.boundary,d=n.rootBoundary,u=n.altBoundary,l=n.padding,p=n.tether,f=void 0===p||p,h=n.tetherOffset,m=void 0===h?0:h,g=Ht(e,{boundary:c,rootBoundary:d,padding:l,altBoundary:u}),y=nt(e.placement),v=_t(e.placement),b=!v,w=yt(y),x="x"===w?"y":"x",_=e.modifiersData.popperOffsets,E=e.rects.reference,O=e.rects.popper,C="function"==typeof m?m(Object.assign({},e.rects,{placement:e.placement})):m,A="number"==typeof C?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),S=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,k={x:0,y:0};if(_){if(i){var T,L="y"===w?W:z,I="y"===w?j:B,M="y"===w?"height":"width",P=_[w],D=P+g[L],H=P-g[I],$=f?-O[M]/2:0,q=v===R?E[M]:O[M],N=v===R?-O[M]:-E[M],F=e.elements.arrow,V=f&&F?dt(F):{width:0,height:0},G=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Y=G[L],X=G[I],U=vt(0,E[M],V[M]),J=b?E[M]/2-$-U-Y-A.mainAxis:q-U-Y-A.mainAxis,Z=b?-E[M]/2+$+U+X+A.mainAxis:N+U+X+A.mainAxis,Q=e.elements.arrow&&gt(e.elements.arrow),K=Q?"y"===w?Q.clientTop||0:Q.clientLeft||0:0,tt=null!=(T=null==S?void 0:S[w])?T:0,et=P+Z-tt,it=vt(f?ot(D,P+J-tt-K):D,P,f?rt(H,et):H);_[w]=it,k[w]=it-P}if(s){var at,st="x"===w?W:z,ct="x"===w?j:B,ut=_[x],lt="y"===x?"height":"width",pt=ut+g[st],ft=ut-g[ct],ht=-1!==[W,z].indexOf(y),mt=null!=(at=null==S?void 0:S[x])?at:0,bt=ht?pt:ut-E[lt]-O[lt]-mt+A.altAxis,wt=ht?ut+E[lt]+O[lt]-mt-A.altAxis:ft,xt=f&&ht?function(t,e,n){var r=vt(t,e,n);return r>n?n:r}(bt,ut,wt):vt(f?bt:pt,ut,f?wt:ft);_[x]=xt,k[x]=xt-ut}e.modifiersData[r]=k}},requiresIfExists:["offset"]};function Gt(t,e,n){void 0===n&&(n=!1);var r,o,i=K(e),a=K(e)&&function(t){var e=t.getBoundingClientRect(),n=it(e.width)/t.offsetWidth||1,r=it(e.height)/t.offsetHeight||1;return 1!==n||1!==r}(e),s=ft(e),c=ct(t,a,n),d={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(i||!i&&!n)&&(("body"!==J(e)||Mt(s))&&(d=(r=e)!==Z(r)&&K(r)?{scrollLeft:(o=r).scrollLeft,scrollTop:o.scrollTop}:Lt(r)),K(e)?((u=ct(e,!0)).x+=e.clientLeft,u.y+=e.clientTop):s&&(u.x=It(s))),{x:c.left+d.scrollLeft-u.x,y:c.top+d.scrollTop-u.y,width:c.width,height:c.height}}function Yt(t){var e=new Map,n=new Set,r=[];function o(t){n.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!n.has(t)){var r=e.get(t);r&&o(r)}})),r.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){n.has(t.name)||o(t)})),r}var Xt={placement:"bottom",modifiers:[],strategy:"absolute"};function Ut(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}function Jt(t){void 0===t&&(t={});var e=t,n=e.defaultModifiers,r=void 0===n?[]:n,o=e.defaultOptions,i=void 0===o?Xt:o;return function(t,e,n){void 0===n&&(n=i);var o,a,s={placement:"bottom",orderedModifiers:[],options:Object.assign({},Xt,i),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},c=[],d=!1,u={state:s,setOptions:function(n){var o="function"==typeof n?n(s.options):n;l(),s.options=Object.assign({},i,s.options,o),s.scrollParents={reference:Q(t)?Dt(t):t.contextElement?Dt(t.contextElement):[],popper:Dt(e)};var a,d,p=function(t){var e=Yt(t);return U.reduce((function(t,n){return t.concat(e.filter((function(t){return t.phase===n})))}),[])}((a=[].concat(r,s.options.modifiers),d=a.reduce((function(t,e){var n=t[e.name];return t[e.name]=n?Object.assign({},n,e,{options:Object.assign({},n.options,e.options),data:Object.assign({},n.data,e.data)}):e,t}),{}),Object.keys(d).map((function(t){return d[t]}))));return s.orderedModifiers=p.filter((function(t){return t.enabled})),s.orderedModifiers.forEach((function(t){var e=t.name,n=t.options,r=void 0===n?{}:n,o=t.effect;if("function"==typeof o){var i=o({state:s,name:e,instance:u,options:r}),a=function(){};c.push(i||a)}})),u.update()},forceUpdate:function(){if(!d){var t=s.elements,e=t.reference,n=t.popper;if(Ut(e,n)){s.rects={reference:Gt(e,gt(n),"fixed"===s.options.strategy),popper:dt(n)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(t){return s.modifiersData[t.name]=Object.assign({},t.data)}));for(var r=0;r<s.orderedModifiers.length;r++)if(!0!==s.reset){var o=s.orderedModifiers[r],i=o.fn,a=o.options,c=void 0===a?{}:a,l=o.name;"function"==typeof i&&(s=i({state:s,options:c,name:l,instance:u})||s)}else s.reset=!1,r=-1}}},update:(o=function(){return new Promise((function(t){u.forceUpdate(),t(s)}))},function(){return a||(a=new Promise((function(t){Promise.resolve().then((function(){a=void 0,t(o())}))}))),a}),destroy:function(){l(),d=!0}};if(!Ut(t,e))return u;function l(){c.forEach((function(t){return t()})),c=[]}return u.setOptions(n).then((function(t){!d&&n.onFirstUpdate&&n.onFirstUpdate(t)})),u}}var Zt=Jt({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,n=t.instance,r=t.options,o=r.scroll,i=void 0===o||o,a=r.resize,s=void 0===a||a,c=Z(e.elements.popper),d=[].concat(e.scrollParents.reference,e.scrollParents.popper);return i&&d.forEach((function(t){t.addEventListener("scroll",n.update,Ct)})),s&&c.addEventListener("resize",n.update,Ct),function(){i&&d.forEach((function(t){t.removeEventListener("scroll",n.update,Ct)})),s&&c.removeEventListener("resize",n.update,Ct)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,n=t.name;e.modifiersData[n]=zt({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,n=t.options,r=n.gpuAcceleration,o=void 0===r||r,i=n.adaptive,a=void 0===i||i,s=n.roundOffsets,c=void 0===s||s,d={placement:nt(e.placement),variation:_t(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,Ot(Object.assign({},d,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:c})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,Ot(Object.assign({},d,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},et,Ft,Rt,Vt,xt,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,n=t.name,r=e.rects.reference,o=e.rects.popper,i=e.modifiersData.preventOverflow,a=Ht(e,{elementContext:"reference"}),s=Ht(e,{altBoundary:!0}),c=qt(a,r),d=qt(s,o,i),u=Nt(c),l=Nt(d);e.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:d,isReferenceHidden:u,hasPopperEscaped:l},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":l})}}]}),Qt="tippy-content",Kt="tippy-backdrop",te="tippy-arrow",ee="tippy-svg-arrow",ne={passive:!0,capture:!0},re=function(){return document.body};function oe(t,e,n){if(Array.isArray(t)){var r=t[e];return null==r?Array.isArray(n)?n[e]:n:r}return t}function ie(t,e){var n={}.toString.call(t);return 0===n.indexOf("[object")&&n.indexOf(e+"]")>-1}function ae(t,e){return"function"==typeof t?t.apply(void 0,e):t}function se(t,e){return 0===e?t:function(r){clearTimeout(n),n=setTimeout((function(){t(r)}),e)};var n}function ce(t){return[].concat(t)}function de(t,e){-1===t.indexOf(e)&&t.push(e)}function ue(t){return[].slice.call(t)}function le(t){return Object.keys(t).reduce((function(e,n){return void 0!==t[n]&&(e[n]=t[n]),e}),{})}function pe(){return document.createElement("div")}function fe(t){return["Element","Fragment"].some((function(e){return ie(t,e)}))}function he(t){return fe(t)?[t]:function(t){return ie(t,"NodeList")}(t)?ue(t):Array.isArray(t)?t:ue(document.querySelectorAll(t))}function me(t,e){t.forEach((function(t){t&&(t.style.transitionDuration=e+"ms")}))}function ge(t,e){t.forEach((function(t){t&&t.setAttribute("data-state",e)}))}function ye(t,e,n){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(e){t[r](e,n)}))}function ve(t,e){for(var n=e;n;){var r;if(t.contains(n))return!0;n=null==n.getRootNode||null==(r=n.getRootNode())?void 0:r.host}return!1}var be={isTouch:!1},we=0;function xe(){be.isTouch||(be.isTouch=!0,window.performance&&document.addEventListener("mousemove",_e))}function _e(){var t=performance.now();t-we<20&&(be.isTouch=!1,document.removeEventListener("mousemove",_e)),we=t}function Ee(){var t,e=document.activeElement;if((t=e)&&t._tippy&&t._tippy.reference===t){var n=e._tippy;e.blur&&!n.state.isVisible&&e.blur()}}var Oe=!!("undefined"!=typeof window&&"undefined"!=typeof document)&&!!window.msCrypto,Ce=Object.assign({appendTo:re,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),Ae=Object.keys(Ce);function Se(t){var e=(t.plugins||[]).reduce((function(e,n){var r,o=n.name,i=n.defaultValue;o&&(e[o]=void 0!==t[o]?t[o]:null!=(r=Ce[o])?r:i);return e}),{});return Object.assign({},t,e)}function ke(t,e){var n=Object.assign({},e,{content:ae(e.content,[t])},e.ignoreAttributes?{}:function(t,e){return(e?Object.keys(Se(Object.assign({},Ce,{plugins:e}))):Ae).reduce((function(e,n){var r=(t.getAttribute("data-tippy-"+n)||"").trim();if(!r)return e;if("content"===n)e[n]=r;else try{e[n]=JSON.parse(r)}catch(t){e[n]=r}return e}),{})}(t,e.plugins));return n.aria=Object.assign({},Ce.aria,n.aria),n.aria={expanded:"auto"===n.aria.expanded?e.interactive:n.aria.expanded,content:"auto"===n.aria.content?e.interactive?null:"describedby":n.aria.content},n}var Te=function(){return"innerHTML"};function Le(t,e){t[Te()]=e}function Ie(t){var e=pe();return!0===t?e.className=te:(e.className=ee,fe(t)?e.appendChild(t):Le(e,t)),e}function Me(t,e){fe(e.content)?(Le(t,""),t.appendChild(e.content)):"function"!=typeof e.content&&(e.allowHTML?Le(t,e.content):t.textContent=e.content)}function Pe(t){var e=t.firstElementChild,n=ue(e.children);return{box:e,content:n.find((function(t){return t.classList.contains(Qt)})),arrow:n.find((function(t){return t.classList.contains(te)||t.classList.contains(ee)})),backdrop:n.find((function(t){return t.classList.contains(Kt)}))}}function De(t){var e=pe(),n=pe();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=pe();function o(n,r){var o=Pe(e),i=o.box,a=o.content,s=o.arrow;r.theme?i.setAttribute("data-theme",r.theme):i.removeAttribute("data-theme"),"string"==typeof r.animation?i.setAttribute("data-animation",r.animation):i.removeAttribute("data-animation"),r.inertia?i.setAttribute("data-inertia",""):i.removeAttribute("data-inertia"),i.style.maxWidth="number"==typeof r.maxWidth?r.maxWidth+"px":r.maxWidth,r.role?i.setAttribute("role",r.role):i.removeAttribute("role"),n.content===r.content&&n.allowHTML===r.allowHTML||Me(a,t.props),r.arrow?s?n.arrow!==r.arrow&&(i.removeChild(s),i.appendChild(Ie(r.arrow))):i.appendChild(Ie(r.arrow)):s&&i.removeChild(s)}return r.className=Qt,r.setAttribute("data-state","hidden"),Me(r,t.props),e.appendChild(n),n.appendChild(r),o(t.props,t.props),{popper:e,onUpdate:o}}De.$$tippy=!0;var We=1,je=[],Be=[];function ze(t,e){var n,r,o,i,a,s,c,d,u=ke(t,Object.assign({},Ce,Se(le(e)))),l=!1,p=!1,f=!1,h=!1,m=[],g=se(Y,u.interactiveDebounce),y=We++,v=(d=u.plugins).filter((function(t,e){return d.indexOf(t)===e})),b={id:y,reference:t,popper:pe(),popperInstance:null,props:u,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:v,clearDelayTimeouts:function(){clearTimeout(n),clearTimeout(r),cancelAnimationFrame(o)},setProps:function(e){if(b.state.isDestroyed)return;P("onBeforeUpdate",[b,e]),V();var n=b.props,r=ke(t,Object.assign({},n,le(e),{ignoreAttributes:!0}));b.props=r,F(),n.interactiveDebounce!==r.interactiveDebounce&&(j(),g=se(Y,r.interactiveDebounce));n.triggerTarget&&!r.triggerTarget?ce(n.triggerTarget).forEach((function(t){t.removeAttribute("aria-expanded")})):r.triggerTarget&&t.removeAttribute("aria-expanded");W(),M(),_&&_(n,r);b.popperInstance&&(Z(),K().forEach((function(t){requestAnimationFrame(t._tippy.popperInstance.forceUpdate)})));P("onAfterUpdate",[b,e])},setContent:function(t){b.setProps({content:t})},show:function(){var t=b.state.isVisible,e=b.state.isDestroyed,n=!b.state.isEnabled,r=be.isTouch&&!b.props.touch,o=oe(b.props.duration,0,Ce.duration);if(t||e||n||r)return;if(k().hasAttribute("disabled"))return;if(P("onShow",[b],!1),!1===b.props.onShow(b))return;b.state.isVisible=!0,S()&&(x.style.visibility="visible");M(),$(),b.state.isMounted||(x.style.transition="none");if(S()){var i=L();me([i.box,i.content],0)}s=function(){var t;if(b.state.isVisible&&!h){if(h=!0,x.offsetHeight,x.style.transition=b.props.moveTransition,S()&&b.props.animation){var e=L(),n=e.box,r=e.content;me([n,r],o),ge([n,r],"visible")}D(),W(),de(Be,b),null==(t=b.popperInstance)||t.forceUpdate(),P("onMount",[b]),b.props.animation&&S()&&function(t,e){q(t,e)}(o,(function(){b.state.isShown=!0,P("onShown",[b])}))}},function(){var t,e=b.props.appendTo,n=k();t=b.props.interactive&&e===re||"parent"===e?n.parentNode:ae(e,[n]);t.contains(x)||t.appendChild(x);b.state.isMounted=!0,Z()}()},hide:function(){var t=!b.state.isVisible,e=b.state.isDestroyed,n=!b.state.isEnabled,r=oe(b.props.duration,1,Ce.duration);if(t||e||n)return;if(P("onHide",[b],!1),!1===b.props.onHide(b))return;b.state.isVisible=!1,b.state.isShown=!1,h=!1,l=!1,S()&&(x.style.visibility="hidden");if(j(),R(),M(!0),S()){var o=L(),i=o.box,a=o.content;b.props.animation&&(me([i,a],r),ge([i,a],"hidden"))}D(),W(),b.props.animation?S()&&function(t,e){q(t,(function(){!b.state.isVisible&&x.parentNode&&x.parentNode.contains(x)&&e()}))}(r,b.unmount):b.unmount()},hideWithInteractivity:function(t){T().addEventListener("mousemove",g),de(je,g),g(t)},enable:function(){b.state.isEnabled=!0},disable:function(){b.hide(),b.state.isEnabled=!1},unmount:function(){b.state.isVisible&&b.hide();if(!b.state.isMounted)return;Q(),K().forEach((function(t){t._tippy.unmount()})),x.parentNode&&x.parentNode.removeChild(x);Be=Be.filter((function(t){return t!==b})),b.state.isMounted=!1,P("onHidden",[b])},destroy:function(){if(b.state.isDestroyed)return;b.clearDelayTimeouts(),b.unmount(),V(),delete t._tippy,b.state.isDestroyed=!0,P("onDestroy",[b])}};if(!u.render)return b;var w=u.render(b),x=w.popper,_=w.onUpdate;x.setAttribute("data-tippy-root",""),x.id="tippy-"+b.id,b.popper=x,t._tippy=b,x._tippy=b;var E=v.map((function(t){return t.fn(b)})),O=t.hasAttribute("aria-expanded");return F(),W(),M(),P("onCreate",[b]),u.showOnCreate&&tt(),x.addEventListener("mouseenter",(function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()})),x.addEventListener("mouseleave",(function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&T().addEventListener("mousemove",g)})),b;function C(){var t=b.props.touch;return Array.isArray(t)?t:[t,0]}function A(){return"hold"===C()[0]}function S(){var t;return!(null==(t=b.props.render)||!t.$$tippy)}function k(){return c||t}function T(){var t,e,n=k().parentNode;return n?null!=(e=ce(n)[0])&&null!=(t=e.ownerDocument)&&t.body?e.ownerDocument:document:document}function L(){return Pe(x)}function I(t){return b.state.isMounted&&!b.state.isVisible||be.isTouch||i&&"focus"===i.type?0:oe(b.props.delay,t?0:1,Ce.delay)}function M(t){void 0===t&&(t=!1),x.style.pointerEvents=b.props.interactive&&!t?"":"none",x.style.zIndex=""+b.props.zIndex}function P(t,e,n){var r;(void 0===n&&(n=!0),E.forEach((function(n){n[t]&&n[t].apply(n,e)})),n)&&(r=b.props)[t].apply(r,e)}function D(){var e=b.props.aria;if(e.content){var n="aria-"+e.content,r=x.id;ce(b.props.triggerTarget||t).forEach((function(t){var e=t.getAttribute(n);if(b.state.isVisible)t.setAttribute(n,e?e+" "+r:r);else{var o=e&&e.replace(r,"").trim();o?t.setAttribute(n,o):t.removeAttribute(n)}}))}}function W(){!O&&b.props.aria.expanded&&ce(b.props.triggerTarget||t).forEach((function(t){b.props.interactive?t.setAttribute("aria-expanded",b.state.isVisible&&t===k()?"true":"false"):t.removeAttribute("aria-expanded")}))}function j(){T().removeEventListener("mousemove",g),je=je.filter((function(t){return t!==g}))}function B(e){if(!be.isTouch||!f&&"mousedown"!==e.type){var n=e.composedPath&&e.composedPath()[0]||e.target;if(!b.props.interactive||!ve(x,n)){if(ce(b.props.triggerTarget||t).some((function(t){return ve(t,n)}))){if(be.isTouch)return;if(b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else P("onClickOutside",[b,e]);!0===b.props.hideOnClick&&(b.clearDelayTimeouts(),b.hide(),p=!0,setTimeout((function(){p=!1})),b.state.isMounted||R())}}}function z(){f=!0}function H(){f=!1}function $(){var t=T();t.addEventListener("mousedown",B,!0),t.addEventListener("touchend",B,ne),t.addEventListener("touchstart",H,ne),t.addEventListener("touchmove",z,ne)}function R(){var t=T();t.removeEventListener("mousedown",B,!0),t.removeEventListener("touchend",B,ne),t.removeEventListener("touchstart",H,ne),t.removeEventListener("touchmove",z,ne)}function q(t,e){var n=L().box;function r(t){t.target===n&&(ye(n,"remove",r),e())}if(0===t)return e();ye(n,"remove",a),ye(n,"add",r),a=r}function N(e,n,r){void 0===r&&(r=!1),ce(b.props.triggerTarget||t).forEach((function(t){t.addEventListener(e,n,r),m.push({node:t,eventType:e,handler:n,options:r})}))}function F(){var t;A()&&(N("touchstart",G,{passive:!0}),N("touchend",X,{passive:!0})),(t=b.props.trigger,t.split(/\s+/).filter(Boolean)).forEach((function(t){if("manual"!==t)switch(N(t,G),t){case"mouseenter":N("mouseleave",X);break;case"focus":N(Oe?"focusout":"blur",U);break;case"focusin":N("focusout",U)}}))}function V(){m.forEach((function(t){var e=t.node,n=t.eventType,r=t.handler,o=t.options;e.removeEventListener(n,r,o)})),m=[]}function G(t){var e,n=!1;if(b.state.isEnabled&&!J(t)&&!p){var r="focus"===(null==(e=i)?void 0:e.type);i=t,c=t.currentTarget,W(),!b.state.isVisible&&ie(t,"MouseEvent")&&je.forEach((function(e){return e(t)})),"click"===t.type&&(b.props.trigger.indexOf("mouseenter")<0||l)&&!1!==b.props.hideOnClick&&b.state.isVisible?n=!0:tt(t),"click"===t.type&&(l=!n),n&&!r&&et(t)}}function Y(t){var e=t.target,n=k().contains(e)||x.contains(e);if("mousemove"!==t.type||!n){var r=K().concat(x).map((function(t){var e,n=null==(e=t._tippy.popperInstance)?void 0:e.state;return n?{popperRect:t.getBoundingClientRect(),popperState:n,props:u}:null})).filter(Boolean);(function(t,e){var n=e.clientX,r=e.clientY;return t.every((function(t){var e=t.popperRect,o=t.popperState,i=t.props.interactiveBorder,a=o.placement.split("-")[0],s=o.modifiersData.offset;if(!s)return!0;var c="bottom"===a?s.top.y:0,d="top"===a?s.bottom.y:0,u="right"===a?s.left.x:0,l="left"===a?s.right.x:0,p=e.top-r+c>i,f=r-e.bottom-d>i,h=e.left-n+u>i,m=n-e.right-l>i;return p||f||h||m}))})(r,t)&&(j(),et(t))}}function X(t){J(t)||b.props.trigger.indexOf("click")>=0&&l||(b.props.interactive?b.hideWithInteractivity(t):et(t))}function U(t){b.props.trigger.indexOf("focusin")<0&&t.target!==k()||b.props.interactive&&t.relatedTarget&&x.contains(t.relatedTarget)||et(t)}function J(t){return!!be.isTouch&&A()!==t.type.indexOf("touch")>=0}function Z(){Q();var e=b.props,n=e.popperOptions,r=e.placement,o=e.offset,i=e.getReferenceClientRect,a=e.moveTransition,c=S()?Pe(x).arrow:null,d=i?{getBoundingClientRect:i,contextElement:i.contextElement||k()}:t,u={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(t){var e=t.state;if(S()){var n=L().box;["placement","reference-hidden","escaped"].forEach((function(t){"placement"===t?n.setAttribute("data-placement",e.placement):e.attributes.popper["data-popper-"+t]?n.setAttribute("data-"+t,""):n.removeAttribute("data-"+t)})),e.attributes.popper={}}}},l=[{name:"offset",options:{offset:o}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!a}},u];S()&&c&&l.push({name:"arrow",options:{element:c,padding:3}}),l.push.apply(l,(null==n?void 0:n.modifiers)||[]),b.popperInstance=Zt(d,x,Object.assign({},n,{placement:r,onFirstUpdate:s,modifiers:l}))}function Q(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function K(){return ue(x.querySelectorAll("[data-tippy-root]"))}function tt(t){b.clearDelayTimeouts(),t&&P("onTrigger",[b,t]),$();var e=I(!0),r=C(),o=r[0],i=r[1];be.isTouch&&"hold"===o&&i&&(e=i),e?n=setTimeout((function(){b.show()}),e):b.show()}function et(t){if(b.clearDelayTimeouts(),P("onUntrigger",[b,t]),b.state.isVisible){if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(t.type)>=0&&l)){var e=I(!1);e?r=setTimeout((function(){b.state.isVisible&&b.hide()}),e):o=requestAnimationFrame((function(){b.hide()}))}}else R()}}function He(t,e){void 0===e&&(e={});var n=Ce.plugins.concat(e.plugins||[]);document.addEventListener("touchstart",xe,ne),window.addEventListener("blur",Ee);var r=Object.assign({},e,{plugins:n}),o=he(t).reduce((function(t,e){var n=e&&ze(e,r);return n&&t.push(n),t}),[]);return fe(t)?o[0]:o}He.defaultProps=Ce,He.setDefaultProps=function(t){Object.keys(t).forEach((function(e){Ce[e]=t[e]}))},He.currentInput=be,Object.assign({},et,{effect:function(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow)}});var $e={mouseover:"mouseenter",focusin:"focus",click:"click"};function Re(t,e){var n,r,o,i=[],a=[],s=!1,c=e.target,d=(n=e,r=["target"],o=Object.assign({},n),r.forEach((function(t){delete o[t]})),o),u=Object.assign({},d,{trigger:"manual",touch:!1}),l=Object.assign({touch:Ce.touch},d,{showOnCreate:!0}),p=He(t,u);function f(t){if(t.target&&!s){var n=t.target.closest(c);if(n){var r=n.getAttribute("data-tippy-trigger")||e.trigger||Ce.trigger;if(!n._tippy&&!("touchstart"===t.type&&"boolean"==typeof l.touch||"touchstart"!==t.type&&r.indexOf($e[t.type])<0)){var o=He(n,l);o&&(a=a.concat(o))}}}}function h(t,e,n,r){void 0===r&&(r=!1),t.addEventListener(e,n,r),i.push({node:t,eventType:e,handler:n,options:r})}return ce(p).forEach((function(t){var e=t.destroy,n=t.enable,r=t.disable;t.destroy=function(t){void 0===t&&(t=!0),t&&a.forEach((function(t){t.destroy()})),a=[],i.forEach((function(t){var e=t.node,n=t.eventType,r=t.handler,o=t.options;e.removeEventListener(n,r,o)})),i=[],e()},t.enable=function(){n(),a.forEach((function(t){return t.enable()})),s=!1},t.disable=function(){r(),a.forEach((function(t){return t.disable()})),s=!0},function(t){var e=t.reference;h(e,"touchstart",f,ne),h(e,"mouseover",f),h(e,"focusin",f),h(e,"click",f)}(t)})),p}He.setDefaultProps({render:De});function qe(t){const e=o(t);for(const t of e)for(const e in t)""==t[e]&&delete t[e];return e}Promise.all([fetch("parties.csv"),fetch("events.csv")]).then((t=>Promise.all(t.map((t=>t.text()))))).then((t=>{const e=qe(t[0]),n=qe(t[1]);new D("diagram",{yearStart:1915,panzoom:A},e,n).create()})),new class{constructor(t){const e=this,n=document.getElementById("diagram").querySelectorAll(t);for(const t of n)t.classList.add("entry-popover");Re("#diagram",{target:t,theme:"tl",content:"Loading...",allowHTML:!0,interactive:!0,trigger:"click",onShow(t){e.getPopoverContents(t.reference).then((e=>t.setContent(e))).catch((e=>{console.log(`Error loading info for ${t.reference.id}: ${e}`)}))}})}async getPopoverContents(t){console.log("Contents requested");const e=t.dataset.wikipedia,n=e.substring(e.lastIndexOf("/")+1);return fetch(`https://en.wikipedia.org/w/api.php?format=json&action=query&explaintext&prop=extracts|info|pageprops&exsentences=3&titles=${n}&origin=*`).then((t=>t.json())).then((t=>{const n=t.query.pages[Object.keys(t.query.pages)[0]];return`<h3>${n.title}</h3>\n\t\t\t\t\t\t\t<p>${n.extract}</p>\n\t\t\t\t\t\t\t<p><a href="${e}" class="read-more">Read more on Wikipedia</a></p>`}))}}("[data-wikipedia]")}));
